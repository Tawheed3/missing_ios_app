workflows:
  ios-simulator-workflow:
    name: iOS Simulator Build
    environment:
      vars:
        XCODE_WORKSPACE: "ios/Runner.xcworkspace"
        XCODE_SCHEME: "Runner"
      flutter: stable
      xcode: latest
    scripts:
      - name: تنظيف المشروع
        script: |
          flutter clean
          rm -rf ios/Podfile.lock ios/Pods ios/.symlinks
          rm -rf ~/Library/Developer/Xcode/DerivedData
          cd ios
          pod cache clean --all
          cd ..

      - name: تحديث Flutter
        script: |
          flutter upgrade
          flutter pub get

      - name: إعادة تثبيت Pods بالكامل
        script: |
          cd ios
          pod deintegrate
          pod setup
          pod install --repo-update
          cd ..

      - name: بناء التطبيق للمحاكي
        script: |
          flutter build ios --debug --simulator
    artifacts:
      - build/ios/iphonesimulator/Runner.app
    publishing:
      email:
        recipients:
          - tawheedkortam1@gmail.com